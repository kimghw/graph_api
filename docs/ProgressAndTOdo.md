# 프로젝트 진행 상황 및 할 일

## 프로젝트 진행 상황

### 완료된 작업

#### 1. 프로젝트 구조 설정
- [x] 디렉터리 구조 설정
- [x] .gitignore 설정
- [x] requirements.txt 작성
- [x] .env.example 작성
- [x] Python 가상 환경 설정 (.venv 생성)
- [x] 가상 환경 활성화 스크립트 (activate.sh) 생성
- [x] 로그 디렉토리 생성
- [x] 환경 변수 설정 (.env 파일 생성)
- [x] Git 저장소 초기화 및 main 브랜치 설정

#### 2. 문서화
- [x] README.md 작성
- [x] 사용자 요구사항 문서 (user_requirements.md) 작성
- [x] 프로젝트 설명 문서 (project_description.md) 작성
- [x] 진행 상황 및 할 일 목록 문서 (ProgressAndTOdo.md) 작성

#### 3. 유틸리티 계층
- [x] 로깅 설정 모듈 (logging_config.py) 구현
- [x] 예외 처리 모듈 (exceptions.py) 구현

#### 4. 인프라 계층
- [x] 설정 관리 모듈 (config.py) 구현
- [x] 인증 토큰 관리자 (auth_token.py) 구현
- [x] Graph API 게이트웨이 (graph_gateway.py) 구현

#### 5. DTO/모델 계층
- [x] 인증 관련 데이터 클래스 (auth.py) 구현
- [x] 이메일 관련 데이터 클래스 (email.py) 구현

#### 6. 서비스 계층
- [x] 인증 서비스 (auth_service.py) 구현 완료
- [x] 이메일 서비스 (email_service.py) 구현 완료

#### 7. CLI 인터페이스
- [x] 메인 CLI 모듈 (main.py) 구현
- [x] Graph API CLI 모듈 (graphapi_cli.py) 구현
- [x] 이메일 CLI 모듈 (email_cli.py) 구현

#### 8. API 서버
- [x] FastAPI 기반 API 서버 구현
- [x] 인증 API 라우터 (auth.py) 구현
- [x] API 서버 시작 명령어 CLI 추가

### 진행 중인 작업

#### 1. 테스트 코드
- [ ] 유닛 테스트 작성 준비 중
- [ ] 통합 테스트 작성 준비 중

## 할 일 목록

### 우선 순위: 높음

#### 1. 테스트 코드 작성
- [ ] 테스트 환경 구성
  - [ ] pytest 설정 및 구성
  - [ ] 모킹(mocking) 라이브러리 설정
- [ ] 단위 테스트 작성
  - [ ] 인증 서비스 테스트 케이스 구현
  - [ ] 이메일 서비스 테스트 케이스 구현
- [ ] 통합 테스트 작성
  - [ ] Graph API 연동 테스트
  - [ ] 인증 흐름 테스트

### 우선 순위: 중간

#### 1. 인프라 계층 테스트
- [ ] Config 테스트 구현
- [ ] AuthTokenManager 테스트 구현
- [ ] GraphApiGateway 테스트 구현

#### 2. 기능 개선
- [x] HTML 본문을 텍스트로 변환 기능 구현
- [x] 이메일 필터링 기능 개선
- [x] 다양한 형식(ISO 8601, datetime 객체)의 날짜 검색 지원
- [x] CLI에 date-search 명령어 추가
- [ ] 오류 처리 및 복구 메커니즘 강화

### 우선 순위: 낮음

#### 1. 데이터베이스 연동
- [ ] 로컬 SQLite 연동 기능 구현
- [ ] 이메일 저장 및 관리 기능 구현
- [ ] 쿼리 및 검색 기능 구현

#### 2. 추가 기능
- [ ] 이메일 첨부 파일 처리
- [ ] 일정 및 작업 관리 기능

#### 3. 성능 최적화
- [ ] API 요청 최적화
- [ ] 캐싱 기능 개선
- [ ] 배치 처리 구현

## 알려진 이슈

1. **인증 흐름**: 인증 코드 흐름 구현 시 리디렉션 URI 처리 방안 검토 필요
   - 현재 계획: 로컬 서버를 실행하여 리디렉션 URI로 받은 인증 코드 처리
   - 대안: 수동으로 인증 코드 입력 방식 지원

2. **델타 쿼리**: 송신 메일과 수신 메일의 델타 링크 별도 관리 필요
   - 서로 다른 폴더(sentItems vs inbox)에 대한 델타 쿼리이므로 동일한 델타 링크 사용 불가
   - 구현 방안: 각각의 델타 링크를 별도 키로 저장

3. **API 응답 필드 차이**: 송수신 메일의 필드 구조 차이 처리 필요
   - 송신 메일에는 `sentDateTime` 필드가 있으나 수신 메일에는 `receivedDateTime` 필드 사용
   - 발신자/수신자 정보 구조가 다름 (from vs toRecipients)
   - 구현 방안: 필드 접근 시 항상 키 존재 여부 검증

## 마일스톤

### 마일스톤 1: 기본 인프라 구축 (완료)
- 프로젝트 구조 설정
- 문서화
- 유틸리티 계층 구현
- 서비스 계층 인터페이스 설계
- CLI 인터페이스 구현

### 마일스톤 2: 핵심 기능 구현 (진행 중)
- [x] 인프라 계층 완성
- [x] DTO/모델 계층 완성
- [x] 서비스 계층 완성
- [ ] 기본 테스트 코드 작성
- [ ] 인증 및 기본 이메일 조회 기능 테스트

### 마일스톤 3: 기능 확장 (예정)
- 이메일 필터링 및 검색 기능 개선
- 로컬 데이터베이스 연동
- 추가 기능 구현
- 성능 최적화
